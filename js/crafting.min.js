function rainbow(a,h){var c,g,f,b=h/a,e=~~(6*b),b=6*b-e,d=1-b;switch(e%6){case 0:c=1;g=b;f=0;break;case 1:c=d;g=1;f=0;break;case 2:c=0;g=1;f=b;break;case 3:c=0;g=d;f=1;break;case 4:c=b;g=0;f=1;break;case 5:c=1,g=0,f=d}return"#"+("00"+(~~(255*c)).toString(16)).slice(-2)+("00"+(~~(255*g)).toString(16)).slice(-2)+("00"+(~~(255*f)).toString(16)).slice(-2)}function ImageFormatter(a,h,c){return"<img src='"+c+"' style='max-width:100%;max-height:100%' />"}
function DescriptionFormatter(){return"CTRL+C Here"}function CheckmarkFormatterStr(a,h,c){return parseInt(c)?"<img src='"+templateDir+"/images/slickgrid/tick.png'>":""}function QuantityFormatter(a,h,c){return 1<parseInt(c)?"<div style='font-weight:bold;'>"+c+"</div>":c}var classCount=0;function getRandomClass(){switch(classCount){case 0:return classCount++,"item1";case 1:return classCount++,"item2";case 2:return classCount=0,"item3"}}
function AdditionalFormatter(a,h,c){a=c.split("; ");for(h=0;h<a.length;h++)a[h]="<span class='"+getRandomClass()+"'>"+a[h]+"</span>";return a.join("")}jQuery.noConflict();(function(a){createTable("alchemy");a("select#trade_select").change(function(){createTable(a(this).val())})})(jQuery);
function createTable(a){jQuery.get(templateDir+"/data/crafting_recipes_"+a+".csv",function(a){for(var c={},g=a.split("\n")[0].replace(/[\n\r]/g,"").split(","),f=[],b=1;b<g.length;b++){var e={id:g[b].toLowerCase().replace(" ",""),name:g[b],field:g[b],sortable:!0,width:150,editor:Slick.Editors.Text,headerCssClass:g[b].toLowerCase().replace(" ","")};switch(e.id){case "copypasta":e.formatter=DescriptionFormatter;break;case "icon":e.formatter=ImageFormatter;e.width=64;break;case "quantity":e.formatter=
QuantityFormatter;e.width=75;break;case "emptybottle":e.formatter=CheckmarkFormatterStr;e.width=75;break;case "additional":e.formatter=AdditionalFormatter;e.width=300;break;case "minlevel":case "maxlevel":case "gold":case "ironingot":case "leather":case "wood":case "potato":case "onion":case "carrot":case "meat":case "spices":case "bass":case "cod":case "blackpowder":case "steedgrass":case "inferioranima":case "cloth":case "shipmodule":case "ironore":case "sulfur":case "rawhide":case "nacre":case "cotton":case "mandrake":case "timber":case "resin":e.width=
50}f.push(e)}a=jQuery.csv.toObjects(a);craftingDataView=new Slick.Data.DataView;craftingDataView.beginUpdate();craftingDataView.setItems(a);craftingDataView.setFilter(function(a){for(var i in c)if(void 0!==i&&""!==c[i]){var e=d.getColumns()[d.getColumnIndex(i)],b=c[i].toLowerCase(),g=!1;">"==b.charAt(0)&&(g=!0,b=b.substring(1));var h=!1;"<"==b.charAt(0)&&(h=!0,b=b.substring(1));var f=!1;isFinite(a[e.field])&&(f=!0);if(!f&&-1==a[e.field].toLowerCase().indexOf(c[i].toLowerCase())||f&&g&&parseFloat(b)>=
parseFloat(a[e.field].toLowerCase())||f&&h&&parseFloat(b)<=parseFloat(a[e.field].toLowerCase())||f&&!g&&!h&&a[e.field].toLowerCase()!=b)return!1}return!0});craftingDataView.endUpdate();var d=new Slick.Grid("#craftingGrid",craftingDataView,f,{enableCellNavigation:!0,enableColumnReorder:!0,multiColumnSort:!1,headerRowHeight:30,explicitInitialization:!0,showHeaderRow:!0,rowHeight:64});craftingDataView.onRowCountChanged.subscribe(function(){d.updateRowCount();d.render()});craftingDataView.onRowsChanged.subscribe(function(a,
c){d.invalidateRows(c.rows);d.render()});var j=null;d.onSort.subscribe(function(a,c){var b=c.sortCol.field,e=c.sortAsc?1:-1,g=j;j=function(c,a){var d=c[b],f=a[b];return d==f&&g?g(c,a):!isFinite(d)||!isFinite(f)?(d==f?0:d>f?1:-1)*e:(parseFloat(d)==parseFloat(f)?0:parseFloat(d)>parseFloat(f)?1:-1)*e};craftingDataView.sort(j);d.invalidate();d.render()});jQuery(d.getHeaderRow()).delegate(":input","change keyup",function(){var a=jQuery(this).data("columnId");null!=a&&(c[a]=jQuery.trim(jQuery(this).val()),
craftingDataView.refresh())});d.onHeaderRowCellRendered.subscribe(function(a,b){"icon"!=b.column.id&&"copypasta"!=b.column.id&&(jQuery(b.node).empty(),jQuery("<input class='filter' type='text'>").data("columnId",b.column.id).val(c[b.column.id]).appendTo(b.node))});d.init();d.setSelectionModel(new Slick.CellSelectionModel);d.registerPlugin(new Slick.AutoTooltips);d.getCanvasNode().focus();d.registerPlugin(new Slick.CellExternalCopyManager);jQuery("input.filter").attr("placeholder","Filter")})};
