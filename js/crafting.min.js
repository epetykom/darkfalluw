function rainbow(c,a){var b,i,j,g=a/c,f=~~(6*g),g=6*g-f,d=1-g;switch(f%6){case 0:b=1;i=g;j=0;break;case 1:b=d;i=1;j=0;break;case 2:b=0;i=1;j=g;break;case 3:b=0;i=d;j=1;break;case 4:b=g;i=0;j=1;break;case 5:b=1,i=0,j=d}return"#"+("00"+(~~(255*b)).toString(16)).slice(-2)+("00"+(~~(255*i)).toString(16)).slice(-2)+("00"+(~~(255*j)).toString(16)).slice(-2)}function ImageFormatter(c,a,b){return"<img src='"+b+"' style='max-width:100%;max-height:100%' />"}
function DescriptionFormatter(){return"CTRL+C Here"}function CheckmarkFormatterStr(c,a,b){return parseInt(b)?"<img src='"+templateDir+"/images/slickgrid/tick.png'>":""}function QuantityFormatter(c,a,b){return 1<parseInt(b)?"<div style='font-weight:bold;'>"+b+"</div>":b}var classCount=0;function getRandomClass(){switch(classCount){case 0:return classCount++,"item1";case 1:return classCount++,"item2";case 2:return classCount=0,"item3"}}
function AdditionalFormatter(c,a,b){c=b.split("; ");for(a=0;a<c.length;a++)c[a]="<span class='"+getRandomClass()+"'>"+c[a]+"</span>";return c.join("")}jQuery.noConflict();
(function(c){c("select#trade_select").change(function(){window.location.hash=c(this).val()});c(window).on("hashchange",function(){var a=window.location.hash.substr(1);createTable(a);c("select#trade_select").val(a)});setTimeout(function(){if(""===window.location.hash)window.location.hash="alchemy",c("select#trade_select").val("alchemy");else{var a=window.location.hash.substr(1);createTable(a);c("select#trade_select").val(a)}},2E3)})(jQuery);
function createTable(c){var a=(new Date).getTime();jQuery.get(templateDir+"/data/crafting_recipes_"+c+".csv?cb="+a,function(b){for(var c={},a=b.split("\n")[0].replace(/[\n\r]/g,"").split(","),g=[],f=1;f<a.length;f++){var d={id:a[f].toLowerCase().replace(" ",""),name:a[f],field:a[f],sortable:!0,width:150,editor:Slick.Editors.Text,headerCssClass:a[f].toLowerCase().replace(" ","")};switch(d.id){case "copypasta":d.formatter=DescriptionFormatter;break;case "icon":d.formatter=ImageFormatter;d.width=64;
break;case "quantity":d.formatter=QuantityFormatter;d.width=75;break;case "emptybottle":d.formatter=CheckmarkFormatterStr;d.width=75;break;case "additional":d.formatter=AdditionalFormatter;d.width=300;break;case "minlevel":case "maxlevel":case "gold":case "ironingot":case "leather":case "wood":case "potato":case "onion":case "carrot":case "meat":case "spices":case "bass":case "cod":case "blackpowder":case "steedgrass":case "inferioranima":case "cloth":case "shipmodule":case "ironore":case "sulfur":case "rawhide":case "nacre":case "cotton":case "mandrake":case "timber":case "resin":d.width=
50}g.push(d)}b=jQuery.csv.toObjects(b);craftingDataView=new Slick.Data.DataView;craftingDataView.beginUpdate();craftingDataView.setItems(b);craftingDataView.setFilter(function(a){for(var b in c)if(void 0!==b&&""!==c[b]){var d=e.getColumns()[e.getColumnIndex(b)],h=c[b].toLowerCase(),g=!1;">"==h.charAt(0)&&(g=!0,h=h.substring(1));var f=!1;"<"==h.charAt(0)&&(f=!0,h=h.substring(1));var k=!1;isFinite(a[d.field])&&(k=!0);if(!k&&-1==a[d.field].toLowerCase().indexOf(c[b].toLowerCase())||k&&g&&parseFloat(h)>=
parseFloat(a[d.field].toLowerCase())||k&&f&&parseFloat(h)<=parseFloat(a[d.field].toLowerCase())||k&&!g&&!f&&a[d.field].toLowerCase()!=h)return!1}return!0});craftingDataView.endUpdate();var e=new Slick.Grid("#craftingGrid",craftingDataView,g,{enableCellNavigation:!0,enableColumnReorder:!0,multiColumnSort:!1,headerRowHeight:30,explicitInitialization:!0,showHeaderRow:!0,rowHeight:64});craftingDataView.onRowCountChanged.subscribe(function(){e.updateRowCount();e.render()});craftingDataView.onRowsChanged.subscribe(function(a,
b){e.invalidateRows(b.rows);e.render()});var l=null;e.onSort.subscribe(function(a,b){var c=b.sortCol.field,d=b.sortAsc?1:-1,g=l;l=function(b,a){var e=b[c],f=a[c];return e==f&&g?g(b,a):!isFinite(e)||!isFinite(f)?(e==f?0:e>f?1:-1)*d:(parseFloat(e)==parseFloat(f)?0:parseFloat(e)>parseFloat(f)?1:-1)*d};craftingDataView.sort(l);e.invalidate();e.render()});jQuery(e.getHeaderRow()).delegate(":input","change keyup",function(){var b=jQuery(this).data("columnId");null!=b&&(c[b]=jQuery.trim(jQuery(this).val()),
craftingDataView.refresh())});e.onHeaderRowCellRendered.subscribe(function(b,a){"icon"!=a.column.id&&"copypasta"!=a.column.id&&(jQuery(a.node).empty(),jQuery("<input class='filter' type='text'>").data("columnId",a.column.id).val(c[a.column.id]).appendTo(a.node))});e.init();e.setSelectionModel(new Slick.CellSelectionModel);e.registerPlugin(new Slick.AutoTooltips);e.getCanvasNode().focus();e.registerPlugin(new Slick.CellExternalCopyManager);jQuery("input.filter").attr("placeholder","Filter")})};
