function rainbow(a,g){var c,e,h,f=g/a,b=~~(6*f),f=6*f-b,d=1-f;switch(b%6){case 0:c=1;e=f;h=0;break;case 1:c=d;e=1;h=0;break;case 2:c=0;e=1;h=f;break;case 3:c=0;e=d;h=1;break;case 4:c=f;e=0;h=1;break;case 5:c=1,e=0,h=d}return"#"+("00"+(~~(255*c)).toString(16)).slice(-2)+("00"+(~~(255*e)).toString(16)).slice(-2)+("00"+(~~(255*h)).toString(16)).slice(-2)}function ImageFormatter(a,g,c){return"<img src='"+c+"' style='max-width:100%;max-height:100%' />"}
function DescriptionFormatter(){return"CTRL+C Here"}function CheckmarkFormatterStr(a,g,c){return parseInt(c)?"<img src='"+templateDir+"/images/slickgrid/tick.png'>":""}function QuantityFormatter(a,g,c){return 1<parseInt(c)?"<div style='font-weight:bold;'>"+c+"</div>":c}var classCount=0;function getRandomClass(){switch(classCount){case 0:return classCount++,"item1";case 1:return classCount++,"item2";case 2:return classCount=0,"item3"}}
function AdditionalFormatter(a,g,c){a=c.split("; ");for(g=0;g<a.length;g++)a[g]="<span class='"+getRandomClass()+"'>"+a[g]+"</span>";return a.join("")}jQuery.noConflict();(function(a){createTable("alchemy");a("select#trade_select").change(function(){createTable(a(this).val())})})(jQuery);
function createTable(a){jQuery.get(templateDir+"/data/crafting_recipes_"+a+".csv",function(a){for(var c={},e=a.split("\n")[0].replace(/[\n\r]/g,"").split(","),h=[],f=1;f<e.length;f++){var b={id:e[f].toLowerCase().replace(" ",""),name:e[f],field:e[f],sortable:!0,width:150,editor:Slick.Editors.Text,headerCssClass:e[f].toLowerCase().replace(" ","")};"copypasta"==b.id?b.formatter=DescriptionFormatter:"icon"==b.id?(b.formatter=ImageFormatter,b.width=64):"quantity"==b.id?(b.formatter=QuantityFormatter,
b.width=75):"emptybottle"==b.id?(b.formatter=CheckmarkFormatterStr,b.width=75):"additional"==b.id&&(b.formatter=AdditionalFormatter,b.width=300);h.push(b)}a=jQuery.csv.toObjects(a);craftingDataView=new Slick.Data.DataView;craftingDataView.beginUpdate();craftingDataView.setItems(a);craftingDataView.setFilter(function(a){for(var b in c)if(void 0!==b&&""!==c[b]){var f=d.getColumns()[d.getColumnIndex(b)],e=c[b].toLowerCase(),g=!1;">"==e.charAt(0)&&(g=!0,e=e.substring(1));var h=!1;"<"==e.charAt(0)&&(h=
!0,e=e.substring(1));var i=!1;isFinite(a[f.field])&&(i=!0);if(!i&&-1==a[f.field].toLowerCase().indexOf(c[b].toLowerCase())||i&&g&&parseFloat(e)>=parseFloat(a[f.field].toLowerCase())||i&&h&&parseFloat(e)<=parseFloat(a[f.field].toLowerCase())||i&&!g&&!h&&a[f.field].toLowerCase()!=e)return!1}return!0});craftingDataView.endUpdate();var d=new Slick.Grid("#craftingGrid",craftingDataView,h,{enableCellNavigation:!0,enableColumnReorder:!0,multiColumnSort:!1,headerRowHeight:30,explicitInitialization:!0,showHeaderRow:!0,
rowHeight:64});craftingDataView.onRowCountChanged.subscribe(function(){d.updateRowCount();d.render()});craftingDataView.onRowsChanged.subscribe(function(a,c){d.invalidateRows(c.rows);d.render()});var j=null;d.onSort.subscribe(function(a,c){var b=c.sortCol.field,e=c.sortAsc?1:-1,f=j;j=function(c,a){var d=c[b],g=a[b];return d==g&&f?f(c,a):!isFinite(d)||!isFinite(g)?(d==g?0:d>g?1:-1)*e:(parseFloat(d)==parseFloat(g)?0:parseFloat(d)>parseFloat(g)?1:-1)*e};craftingDataView.sort(j);d.invalidate();d.render()});
jQuery(d.getHeaderRow()).delegate(":input","change keyup",function(){var a=jQuery(this).data("columnId");null!=a&&(c[a]=jQuery.trim(jQuery(this).val()),craftingDataView.refresh())});d.onHeaderRowCellRendered.subscribe(function(a,b){"icon"!=b.column.id&&"copypasta"!=b.column.id&&(jQuery(b.node).empty(),jQuery("<input class='filter' type='text'>").data("columnId",b.column.id).val(c[b.column.id]).appendTo(b.node))});d.init();d.setSelectionModel(new Slick.CellSelectionModel);d.registerPlugin(new Slick.AutoTooltips);
d.getCanvasNode().focus();d.registerPlugin(new Slick.CellExternalCopyManager);jQuery("input.filter").attr("placeholder","Filter")})};
