function rainbow(b,a){var c,h,g,d=a/b,f=~~(6*d),d=6*d-f,e=1-d;switch(f%6){case 0:c=1;h=d;g=0;break;case 1:c=e;h=1;g=0;break;case 2:c=0;h=1;g=d;break;case 3:c=0;h=e;g=1;break;case 4:c=d;h=0;g=1;break;case 5:c=1,h=0,g=e}return"#"+("00"+(~~(255*c)).toString(16)).slice(-2)+("00"+(~~(255*h)).toString(16)).slice(-2)+("00"+(~~(255*g)).toString(16)).slice(-2)}function ImageFormatter(b,a,c){return"<img src='"+c+"' style='max-width:100%;max-height:100%' />"}
function DescriptionFormatter(){return"CTRL+C Here"}function CheckmarkFormatterStr(b,a,c){return parseInt(c)?"<img src='"+templateDir+"/images/slickgrid/tick.png'>":""}function QuantityFormatter(b,a,c){return 1<parseInt(c)?"<div style='font-weight:bold;'>"+c+"</div>":c}var classCount=0;function getRandomClass(){switch(classCount){case 0:return classCount++,"item1";case 1:return classCount++,"item2";case 2:return classCount=0,"item3"}}
function AdditionalFormatter(b,a,c){b=c.split("; ");for(a=0;a<b.length;a++)b[a]="<span class='"+getRandomClass()+"'>"+b[a]+"</span>";return b.join("")}jQuery.noConflict();
(function(b){b("select#trade_select").change(function(){window.location.hash=b(this).val()});b(window).on("hashchange",function(){var a=window.location.hash.substr(1);createTable(a);b("select#trade_select").val(a)});setTimeout(function(){if(""===window.location.hash)window.location.hash="alchemy",b("select#trade_select").val("alchemy");else{var a=window.location.hash.substr(1);createTable(a);b("select#trade_select").val(a)}},2E3)})(jQuery);
function createTable(b){jQuery.get(templateDir+"/data/crafting_recipes_"+b+".csv",function(a){for(var c={},b=a.split("\n")[0].replace(/[\n\r]/g,"").split(","),g=[],d=1;d<b.length;d++){var f={id:b[d].toLowerCase().replace(" ",""),name:b[d],field:b[d],sortable:!0,width:150,editor:Slick.Editors.Text,headerCssClass:b[d].toLowerCase().replace(" ","")};switch(f.id){case "copypasta":f.formatter=DescriptionFormatter;break;case "icon":f.formatter=ImageFormatter;f.width=64;break;case "quantity":f.formatter=
QuantityFormatter;f.width=75;break;case "emptybottle":f.formatter=CheckmarkFormatterStr;f.width=75;break;case "additional":f.formatter=AdditionalFormatter;f.width=300;break;case "minlevel":case "maxlevel":case "gold":case "ironingot":case "leather":case "wood":case "potato":case "onion":case "carrot":case "meat":case "spices":case "bass":case "cod":case "blackpowder":case "steedgrass":case "inferioranima":case "cloth":case "shipmodule":case "ironore":case "sulfur":case "rawhide":case "nacre":case "cotton":case "mandrake":case "timber":case "resin":f.width=
50}g.push(f)}a=jQuery.csv.toObjects(a);craftingDataView=new Slick.Data.DataView;craftingDataView.beginUpdate();craftingDataView.setItems(a);craftingDataView.setFilter(function(b){for(var a in c)if(void 0!==a&&""!==c[a]){var f=e.getColumns()[e.getColumnIndex(a)],d=c[a].toLowerCase(),g=!1;">"==d.charAt(0)&&(g=!0,d=d.substring(1));var h=!1;"<"==d.charAt(0)&&(h=!0,d=d.substring(1));var i=!1;isFinite(b[f.field])&&(i=!0);if(!i&&-1==b[f.field].toLowerCase().indexOf(c[a].toLowerCase())||i&&g&&parseFloat(d)>=
parseFloat(b[f.field].toLowerCase())||i&&h&&parseFloat(d)<=parseFloat(b[f.field].toLowerCase())||i&&!g&&!h&&b[f.field].toLowerCase()!=d)return!1}return!0});craftingDataView.endUpdate();var e=new Slick.Grid("#craftingGrid",craftingDataView,g,{enableCellNavigation:!0,enableColumnReorder:!0,multiColumnSort:!1,headerRowHeight:30,explicitInitialization:!0,showHeaderRow:!0,rowHeight:64});craftingDataView.onRowCountChanged.subscribe(function(){e.updateRowCount();e.render()});craftingDataView.onRowsChanged.subscribe(function(b,
a){e.invalidateRows(a.rows);e.render()});var j=null;e.onSort.subscribe(function(b,a){var c=a.sortCol.field,d=a.sortAsc?1:-1,f=j;j=function(b,a){var e=b[c],g=a[c];return e==g&&f?f(b,a):!isFinite(e)||!isFinite(g)?(e==g?0:e>g?1:-1)*d:(parseFloat(e)==parseFloat(g)?0:parseFloat(e)>parseFloat(g)?1:-1)*d};craftingDataView.sort(j);e.invalidate();e.render()});jQuery(e.getHeaderRow()).delegate(":input","change keyup",function(){var b=jQuery(this).data("columnId");null!=b&&(c[b]=jQuery.trim(jQuery(this).val()),
craftingDataView.refresh())});e.onHeaderRowCellRendered.subscribe(function(b,a){"icon"!=a.column.id&&"copypasta"!=a.column.id&&(jQuery(a.node).empty(),jQuery("<input class='filter' type='text'>").data("columnId",a.column.id).val(c[a.column.id]).appendTo(a.node))});e.init();e.setSelectionModel(new Slick.CellSelectionModel);e.registerPlugin(new Slick.AutoTooltips);e.getCanvasNode().focus();e.registerPlugin(new Slick.CellExternalCopyManager);jQuery("input.filter").attr("placeholder","Filter")})};
