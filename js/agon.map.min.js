function CustomMapType(){}CustomMapType.prototype.tileSize=new google.maps.Size(256,256);CustomMapType.prototype.maxZoom=7;CustomMapType.prototype.getTile=function(a,b,c){var c=c.createElement("DIV"),d=templateDir+"/images/tiles/",d=d+(b+"_"+a.x+"_"+a.y+".png");c.style.width=this.tileSize.width+"px";c.style.height=this.tileSize.height+"px";c.style.backgroundColor="#00000";c.style.backgroundImage="url("+d+")";return c};CustomMapType.prototype.name="Custom";CustomMapType.prototype.alt="Tile Coordinate Map Type";
var map,CustomMapType=new CustomMapType,fullscreen=!1,showMobs=!1,showBanks=!1,showCrafts=!1,showBinds=!1,showPortals=!1,showHoldings=!1,showVillages=!1,mobs=[],banks=[],binds=[],crafts=[],portals=[],chambers=[],holdings=[],villages=[];
function map_initialize(){var a={minZoom:3,maxZoom:7,isPng:!0,mapTypeControl:!1,streetViewControl:!1,center:new google.maps.LatLng(73,-109),zoom:4,mapTypeControlOptions:{mapTypeIds:["custom",google.maps.MapTypeId.ROADMAP],style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};map=new google.maps.Map(document.getElementById("map_canvas"),a);map.mapTypes.set("custom",CustomMapType);map.setMapTypeId("custom");google.maps.event.addListener(map,"click",function(a){placeMarker(a.latLng)});getPOIs()}
var marker,poiArray;function getUserLoc(a){a=a.split("%7C");a=new google.maps.LatLng(a[0],a[1]);placeMarker(a);map&&(map.setZoom(7),map.setCenter(a))}
function placeMarker(a){marker?(marker.setPosition(a),marker.title="Click Me!"):(marker=new google.maps.Marker({position:a,map:map,icon:templateDir+"/images/poi-default.png",title:"Click Me!"}),google.maps.event.addListener(marker,"click",function(){copyToClipboard(marker)}));window.location.hash=marker.getPosition().lat()+"%7C"+marker.getPosition().lng()}
function copyToClipboard(a){window.prompt("Copy to clipboard: Ctrl+C, Enter","http://darkfallunholywars.info/world-map/#"+a.getPosition().lat()+"|"+a.getPosition().lng())}function getPOIs(){mobs.length||(jQuery.ajax({url:templateDir+"/getPOIs.php",dataType:"json",success:function(a){poiArray=a.pois;createMarkers()},error:function(){alert("Problem with Map. Please contact us through the feedback form describing what happened! Thanks!")}}),""!=userPOI&&getUserLoc(userPOI))}
function createMarkers(){for(var a=null,b,c=0;c<poiArray.length;c++){switch(poiArray[c]._poi_type){case "bank":b=templateDir+"/images/poi-bank.png";a=banks;break;case "mob":b=""==poiArray[c]._poi_level?templateDir+"/images/poi-mob.png":templateDir+"/images/poi-mob-"+poiArray[c]._poi_level+".png";a=mobs;break;case "city":b=templateDir+"/images/poi-city.png";a=holdings;break;case "hamlet":b=templateDir+"/images/poi-hamlet.png";a=holdings;break;case "cbind":b=templateDir+"/images/poi-bind-chaos.png";
a=binds;break;case "sbind":b=templateDir+"/images/poi-bind-safe.png";a=binds;break;case "craft":b=templateDir+"/images/poi-craft.png";a=crafts;break;case "portal":b=templateDir+"/images/poi-portal.png";a=portals;break;case "pchamber":b=templateDir+"/images/poi-chamber.png";a=portals;break;case "village":b=templateDir+"/images/poi-village.png",a=villages}var d=poiArray[c]._poi_loc.split("|"),d=new google.maps.LatLng(d[0],d[1]),e=new google.maps.Marker({position:d,map:null,icon:b,title:poiArray[c].title});
google.maps.event.addListener(e,"dblclick",function(){copyToClipboard(e)});google.maps.event.addListener(e,"click",function(a){map.setZoom(7);map.setCenter(a.latLng)});a.push(e)}}
function showMarkers(a){var b;switch(a){case "mobs":b=mobs;break;case "banks":b=banks;break;case "crafts":b=crafts;break;case "binds":b=binds;break;case "portals":b=portals;break;case "holdings":b=holdings;break;case "villages":b=villages}for(var a=new google.maps.LatLngBounds,c=0;c<b.length;c++)b[c].setMap(map),a.extend(b[c].getPosition()),map.fitBounds(a)}
function hideMarkers(a){var b;switch(a){case "mobs":b=mobs;break;case "banks":b=banks;break;case "crafts":b=crafts;break;case "binds":b=binds;break;case "portals":b=portals;break;case "holdings":b=holdings;break;case "villages":b=villages}for(a=0;a<b.length;a++)b[a].setMap(null)}
function checkToggles(){jQuery.each(jQuery("#map-legend a"),function(){if(jQuery(this).hasClass("active"))switch(jQuery(this).attr("id")){case "mob-btn":showMarkers("mobs");break;case "bank-btn":showMarkers("banks");break;case "craft-btn":showMarkers("crafts");break;case "bind-btn":showMarkers("binds");break;case "portal-btn":showMarkers("portals");break;case "holding-btn":showMarkers("holdings");break;case "village-btn":showMarkers("villages")}})};
